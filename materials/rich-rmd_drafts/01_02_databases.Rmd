---
title: "01_02_databases"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(DBI)
library(RMariaDB)
```

## Working with Data in a Database, Part II

Databases rule! There is something of a learning curve when first using them but there are some great advantages:

- we know where the data is
- the data is in one place (in that, this is the source of truth)
- many people can have simultaneous access to the same data
- database tables can be updated with new data, with minimal disruption
- {are there others? let me know}

There are some inevitable downsides to keep in mind

- queries can get stuck in queue sometimes
- tables can be accidentally deleted or badly altered
- availability may only be through certain IP addresses
- some dplyr statements may not work at all (no SQL equivalent)
- some dplyr statements may create inefficient SQL (this is rarer but it can happen)
- {others? speak up those with experience}

For this workshop we have a MySQL database available on AWS. I'll provide the necessary information about how to access it here. Let's make a connection to the database (i.e., create a `con` object):

```{r mysql_connection_to_db}
# This will be supplied at the day of the workshop,
# and that's for security reasons
dbname <- ""
username <- ""
password <- ""
host <- ""
port <- ""

con <- 
  dbConnect(
    drv = RMariaDB::MariaDB(),
    dbname = dbname,
    username = username,
    host = host,
    port = port
  )
```

To determine which tables are in the database, we can use the `DBI::dbListTables()` function. 

```{r list_tables}
DBI::dbListTables(con)
```

Those are the tables that the **intendo** organization uses on a daily basis. They contain all of the data on users' sessions (`daily_users`), any revenue generated (`revenue`), and summarized information on user history (`users`) for their one game called **Super Jetroid**.

## YOUR TURN, IT'S TIME TO CODE

Now, a thing to do (to enable data access to the data users in the org) is to write some functions. Here are the functions to write:

- One function that creates a connection object to the `intendo` database (*ans_01_02.1*)
- Three functions that create a `tbl_dbi` object for the three tables in a the `intendo` database (*ans_01_02.2*)

